' Compile this with QBX.  This should run slightly faster in compiled .exe form.

DIM XCIRC(30), YCIRC(30), XCIRC1(30), YCIRC1(30) AS INTEGER
XCIRC(1) = 100
YCIRC(1) = 100
XCIRC1(1) = 400
YCIRC1(1) = 300
DIR = 0
DIR1 = 0
CODA = 1
CODA1 = 1
RANDOMIZE TIMER
SCREEN 12

DO
L = 1 + (TIMER * .3333333) MOD 15:
L1 = 1 + L

EXCODA = CODA
CODA = CODA + 1
IF CODA > 29 THEN CODA = 1
CIRCLE (XCIRC(CODA), YCIRC(CODA)), 5, 0
PSET (XCIRC(CODA), YCIRC(CODA)), L
IF RND < .5 THEN DIR = DIR + .3 ELSE DIR = DIR - .3
NUOVOX = (XCIRC(EXCODA) + 4 * COS(DIR)) MOD 640
NUOVOY = (YCIRC(EXCODA) + 4 * SIN(DIR)) MOD 480
IF NUOVOX < 0 THEN NUOVOX = NUOVOX + 640
IF NUOVOY < 0 THEN NUOVOY = NUOVOY + 480
XCIRC(CODA) = NUOVOX
YCIRC(CODA) = NUOVOY
CIRCLE (NUOVOX, NUOVOY), 5, L

EXCODA1 = CODA1
CODA1 = CODA1 + 1
IF CODA1 > 29 THEN CODA1 = 1
CIRCLE (XCIRC1(CODA1), YCIRC1(CODA1)), 5, 0
PSET (XCIRC1(CODA1), YCIRC1(CODA1)), L1
IF RND < .5 THEN DIR1 = DIR1 + .3 ELSE DIR1 = DIR1 - .3
NUOVOX1 = (XCIRC1(EXCODA1) + 4 * COS(DIR1)) MOD 640
NUOVOY1 = (YCIRC1(EXCODA1) + 4 * SIN(DIR1)) MOD 480
IF NUOVOX1 < 0 THEN NUOVOX1 = NUOVOX1 + 640
IF NUOVOY1 < 0 THEN NUOVOY1 = NUOVOY1 + 480
XCIRC1(CODA1) = NUOVOX1
YCIRC1(CODA1) = NUOVOY1
CIRCLE (NUOVOX1, NUOVOY1), 5, L1

FOR z = 1 TO 2000: NEXT

LOOP UNTIL LEN(INKEY$)

